---

name: Common test information
description: Some information for tests

# Variables should just be a mapping of key: value pairs
variables:

  protocol1: https
  host_gorest: gorest.co.in
  res_users: /public-api/users

  protocol2: http
  host_rp: www.recipepuppy.com
  res_rp: /api/

  host_zipo: api.zippopotam.us

#name: Adding new random user
#description: Reusable test step for adding new random user.

stages:
  - id: add_rand_user
    name: Authenticate and add new random user
    request:
      url: https://gorest.co.in/public-api/users
      method: POST
      headers:
        Content-Type: application/json
        Authorization: Bearer 0fVcl9o-ZPi5TbinICi7OU4fm_GJ_7q0O6ea
      json:
        $ext:
          function: utils:generate_req3

    response:
      status_code:
        - 200
        - 302 # the requested resource has been temporarily moved to a different URI
      json:
        _meta:
          message: "A resource was successfully created in response to a POST request. The Location header contains the URL pointing to the newly created resource."
        result:
          id: !anystr
      save:
        json:
          user_id: result.id

  - id: update_user_rand
    name: Update user

    request:
      url: https://gorest.co.in/public-api/users/{user_id}
      method: PUT
      headers:
        Content-Type: application/json
        Authorization: Bearer 0fVcl9o-ZPi5TbinICi7OU4fm_GJ_7q0O6ea
      json:
        $ext:
          function: utils:generate_req3

    response:
      status_code:
        - 200
        - 302 # the requested resource has been temporarily moved to a different URI
      json:
        _meta:
          message: "OK. Everything worked as expected."
        result:
          id: !anystr
      save:
        json:
          user_id_upd: result.id

  - id: delete_user
    name: Delete user

    request:
      url: https://gorest.co.in/public-api/users/{user_id}
      method: DELETE
      headers:
        Content-Type: application/json
        Authorization: Bearer 0fVcl9o-ZPi5TbinICi7OU4fm_GJ_7q0O6ea

    response:
      status_code: 200
      verify_response_with:
        function: utils:log_response

      json:
        _meta:
          code: 204
          message: "The request was handled successfully and the response contains no body content."
